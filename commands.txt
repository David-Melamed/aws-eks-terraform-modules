commands:
##Create aws-load-balancer-controller iam service account
kubectl apply -f deployment/aws-load-balancer-controller-sa.yaml

## Instal aws-load-balancer-controller
helm install aws-load-balancer-controller eks/aws-load-balancer-controller --set clusterName=ekslab --set serviceAccount.create=false --set region=eu-west-1 --set vpcId=vpc-0ecb81b584011100b --set serviceAccount.name=aws-load-balancer-controller -n kube-system


##Verification
kubectl get deployment -n kube-system aws-load-balancer-controller


#Rollback
#Delete IAM serviceAccount
eksctl delete iamserviceaccount --cluster=ekslab --name=aws-load-balancer-controller --namespace=kube-system

## Delete aws-load-balancer-controller
helm delete aws-load-balancer-controller -n kube-system

#Get token
aws eks get-token --cluster-name ekslab --role-arn arn:aws:iam::<ACCOUNT_ID>:role/<CLUSTER_ROLE_NAME>

#Edit cluster auth configmap to allow RBAC permissions (replace content of auth.yaml)
kubectl edit configmap aws-auth -n kube-system

#Associate OIDC permission to EKS cluster
eksctl utils associate-iam-oidc-provider \
    --region eu-west-1 \
    --cluster ekslab \
    --approve
